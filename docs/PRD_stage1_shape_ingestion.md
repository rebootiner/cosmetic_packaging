# PRD — 화장품 용기 포장 최적화 AI (1단계: 이미지 기반 형상 자동 생성)

작성일: 2026-02-07 (UTC)  
버전: v0.2

---

## 1. 문서 목적

본 PRD는 전체 서비스 중 **1단계(제품 형상 자동 파악/표준화)** 개발 범위를 정의합니다.  
핵심 목표는 사용자가 **제품 이미지를 업로드만 하면**, 시스템이 자동으로 제품 형상을 3D로 구성하고 치수를 산출해 보여주며, 필요 시 최소 수정만으로 확정할 수 있게 하는 것입니다.

---

## 2. 배경 및 문제정의

현업 사용자는 CAD/STP를 항상 보유하지 않으며, 입력이 번거로우면 도입이 어렵습니다.  
따라서 1단계는 아래 원칙을 따릅니다.

- 입력은 최대한 단순하게: **이미지 업로드 중심**
- 시스템이 자동 처리: 형상 추정, 치수 산출, 3D 미리보기 생성
- 사용자 개입은 최소화: **필요 시 치수만 보정**

---

## 3. 목표 / 비목표

### 3.1 목표 (In Scope)
1. 제품 이미지 업로드(모바일/PC) 지원
2. 이미지 기반 형상 자동 추정(3D 근사 모델 생성)
3. 자동 치수 산출(가로/세로/높이/최대직경 등)
4. 3D 미리보기 제공(회전/줌)
5. 사용자 치수 수정(선택)
6. 수정 반영 후 표준 Geometry JSON 생성
7. 품질지표(신뢰도/오차 추정) 제공

### 3.2 비목표 (Out of Scope)
- 최대 적재 계산 로직(2단계)
- 포장 방식 추천(벌크/정렬/물결/트레이)
- 엑셀 사양서 자동 기입
- 고급 물리 시뮬레이션(낙하/진동)

---

## 4. 사용자 및 사용자 스토리

### 4.1 주요 사용자
- 포장기술 담당자
- 생산기술/개발 담당자
- 영업기술/제안 담당자

### 4.2 사용자 스토리
- 사용자는 제품 사진(또는 도면 이미지)만 업로드하고 자동으로 3D 형상을 확인하고 싶다.
- 사용자는 자동 추출된 치수를 확인하고, 틀린 값만 간단히 수정하고 싶다.
- 사용자는 수정 확정 후 다음 단계(적재 계산)로 바로 넘기고 싶다.

---

## 5. 기능 요구사항

## FR-1. 최소 입력 UX
- FR-1.1: 첫 화면에서 업로드 CTA 단일화
  - "제품 이미지 업로드"를 기본 플로우로 제공
- FR-1.2: 사용자가 직접 입력해야 하는 필드는 기본적으로 없음
- FR-1.3: 예외적으로 필요한 경우에만 선택 입력 제공
  - 기준 스케일(예: 자/동전 기준)
  - 제품 카테고리(펌프형/튜브형/용기형)

## FR-2. 이미지 처리 및 형상 추정
- FR-2.1: 배경 분리(세그멘테이션)
- FR-2.2: 윤곽/특징점 추출
- FR-2.3: 3D 근사 형상 생성(primitive fitting + 파라메트릭 재구성)
- FR-2.4: 형상 타입 자동 분류(원통/타원/사각/혼합)

## FR-3. 치수 자동 산출
- FR-3.1: 기본 치수 자동 산출
  - width, depth, height, max_diameter
- FR-3.2: 체적 추정
- FR-3.3: 품질지표 산출
  - shape_confidence
  - dimension_tolerance_mm

## FR-4. 사용자 검증/수정
- FR-4.1: 3D 미리보기에서 치수 오버레이 표시
- FR-4.2: 치수 수동 수정 UI 제공(선택)
- FR-4.3: 수정값 반영해 모델/JSON 즉시 재생성

## FR-5. 표준 출력 생성
- FR-5.1: Geometry JSON 생성
- FR-5.2: preview mesh(GLB 권장, STL 선택) 생성
- FR-5.3: 2단계 엔진 호출 가능한 표준 포맷 유지

---

## 6. 출력 데이터 스키마 (초안)

```json
{
  "product_id": "string",
  "source_type": "image",
  "input_assets": {
    "image_paths": ["string"]
  },
  "dimensions_mm": {
    "width": 0,
    "depth": 0,
    "height": 0,
    "max_diameter": 0
  },
  "volume_mm3": 0,
  "shape_proxy": {
    "type": "obb | cylinder | convex_hull | hybrid",
    "params": {}
  },
  "allowed_orientations": [
    {"rx": 0, "ry": 0, "rz": 0},
    {"rx": 0, "ry": 0, "rz": 90}
  ],
  "quality": {
    "shape_confidence": 0.0,
    "dimension_tolerance_mm": 0.0
  },
  "user_corrections": {
    "applied": false,
    "fields": []
  },
  "assets": {
    "mesh_glb_path": "string",
    "thumbnail_path": "string"
  },
  "created_at": "ISO-8601"
}
```

---

## 7. 비기능 요구사항

- NFR-1 성능
  - 이미지 업로드 후 초안 결과(치수+3D) 15초 이내

- NFR-2 사용성
  - 업로드 후 확정까지 사용자 클릭 5회 이내 목표
  - 사용자 직접 입력 필드 수 최소화(기본 0개)

- NFR-3 정확도
  - 자동 치수 오차 목표: 5% 이내(표준 촬영 조건)
  - 사용자 보정 후 업무 사용 가능 수준 확보

- NFR-4 추적성/보안
  - 입력 이미지, 추출값, 보정 이력 저장
  - 고객 데이터 암호화 저장(At-rest)

---

## 8. UX 요구사항 (MVP)

1. **업로드 화면 (단일 진입점)**
   - 제품 이미지 업로드
   - (선택) 기준 길이 입력

2. **자동 결과 화면**
   - 3D 미리보기(회전/줌)
   - 치수 자동 표시(가로/세로/높이/직경)
   - 신뢰도/오차 안내

3. **수정 화면(필요 시만)**
   - 치수 숫자 수정
   - 즉시 재계산/재렌더링

4. **확정/저장**
   - Geometry JSON 저장
   - 다음 단계(적재 계산)로 전달

---

## 9. 성공 지표 (KPI)

- KPI-1: 업로드 후 자동 3D 생성 성공률 ≥ 90%
- KPI-2: 사용자 무수정 확정률 ≥ 60%
- KPI-3: 사용자 보정 포함 최종 확정률 ≥ 95%
- KPI-4: 업로드→확정 평균 시간 ≤ 2분

---

## 10. 기술 제안 (초안)

- Backend
  - Python (FastAPI)
  - CV/추정: segmentation + contour + parametric fitting
  - Geometry 처리: trimesh / custom geometry utils

- Frontend
  - React
  - 3D Viewer: Three.js (react-three-fiber)

- 저장
  - 객체 저장소: 입력 이미지/mesh
  - DB: 제품 메타/JSON/보정이력/처리로그

---

## 11. 리스크 및 대응

1. 단일 이미지 기반 추정 오차
- 대응: 품질지표 노출 + 보정 UX + 다각도 이미지 업로드 옵션

2. 배경/조명/원근 왜곡 이슈
- 대응: 촬영 가이드 제공(권장 배경/거리) + 전처리 강화

3. 비정형 형상 정확도 한계
- 대응: hybrid proxy 저장 + 2단계에서 보수적 안전 여유 적용

---

## 12. 개발 마일스톤 (MVP)

- M1 (1주): 업로드 UX + 이미지 전처리/세그멘테이션 PoC
- M2 (1주): 형상 근사 + 치수 산출 엔진
- M3 (1주): 3D 뷰어 + 치수 보정 UI + JSON 생성
- M4 (1주): 품질지표/로그/안정화 테스트

총 4주 MVP 기준

---

## 13. 오픈 이슈

1. 이미지 1장 기본 vs 다각도 2~3장 권장 정책
2. 기준 스케일 자동 인식(참조 물체) 지원 여부
3. 신뢰도(score) 계산식 확정
4. 촬영 가이드 자동 피드백(흔들림/초점/각도) 제공 여부

---

## 14. 승인 기준 (Definition of Done)

다음 항목 충족 시 1단계 MVP 완료로 간주:
- 제품 이미지 업로드만으로 자동 3D/치수 생성 가능
- 사용자는 필요 시 치수만 수정 가능
- 수정 반영 후 Geometry JSON 재생성 가능
- 신뢰도/오차 정보가 사용자에게 표시됨
- 2단계 적재 엔진으로 전달 가능한 표준 포맷 산출 가능
